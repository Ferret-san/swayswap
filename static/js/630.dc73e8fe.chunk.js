"use strict";(self.webpackChunkswayswap_demo=self.webpackChunkswayswap_demo||[]).push([[630],{9909:function(e,n,t){t.d(n,{_:function(){return V},M:function(){return U}});var a=t(1413),s=t(885),r=t(4925),o=t(612),i=t(3580),l=t(2791),c=t(948),u=t(9478),d=t(3853),f=t(5479),m=t(3426),x=t(401),h=t(1694),g=t.n(h),v=t(3599),p=t(184),y=["className"],b="appearance-none w-full rounded-md bg-gray-700 px-4 py-2 focus-ring text-gray-100",j=(0,l.forwardRef)((function(e,n){var t=e.className,s=(0,r.Z)(e,y),o=(0,l.useRef)(null),i=(0,x.E)(s,o).inputProps;return(0,p.jsx)("input",(0,a.Z)({ref:(0,v.Z)([o,n]),className:g()(t,b)},i))})),w=t(2982),N=t(7965),I=t(6367),Z=t(686),B=["className","onAction","focusOnMount"];function S(e){var n=e.item,t=e.state,s=e.onAction,r=e.className,o=(0,l.useRef)(null),i=t.disabledKeys.has(n.key),c=t.selectionManager.focusedKey===n.key,u=(0,N.iX)({key:n.key,isDisabled:i,onAction:s},t,o).menuItemProps;return(0,p.jsx)("li",(0,a.Z)((0,a.Z)({},u),{},{ref:o,className:r,"data-focused":c,children:n.rendered}))}var C=function(e){var n=e.className,t=e.onAction,s=e.focusOnMount,o=(0,r.Z)(e,B),i=(0,I.D)((0,a.Z)((0,a.Z)({},o),{},{selectionMode:"none"})),c=(0,l.useRef)(null),u=(0,N.H9)(o,i,c).menuProps;return(0,l.useEffect)((function(){var e;s&&(null===(e=c.current)||void 0===e||e.focus())}),[]),(0,p.jsx)("ul",(0,a.Z)((0,a.Z)({},u),{},{ref:c,className:n,children:(0,w.Z)(i.collection).map((function(e){return(0,p.jsx)(S,{className:e.props.className,item:e,state:i,onAction:t},e.key)}))}))},E=Z.ck;C.Item=E;var k="py-2 px-6 flex items-center gap-3 border-t border-gray-700\n  hover:bg-gray-700/50 hover:cursor-pointer focus-ring",A="px-6 py-4 border-t border-gray-700";function P(e){var n=e.onSelect,t=(0,l.useState)(""),a=(0,s.Z)(t,2),r=a[0],o=a[1];var i=f.Z.filter((function(e){var n;return Boolean(r.length)?null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(r.toLocaleLowerCase()):e})),c=Boolean(i.length);return(0,p.jsxs)("div",{children:[(0,p.jsxs)("header",{className:"py-4 px-6 pb-5",children:[(0,p.jsx)("h2",{className:"text-gray-50 text-lg mb-3",children:"Select a token"}),(0,p.jsx)(j,{type:"text",placeholder:"Search by name...",value:r,onChange:o})]}),c?(0,p.jsx)(C,{onAction:function(e){return null===n||void 0===n?void 0:n(e)},className:"pb-2",focusOnMount:!0,children:i.map((function(e){return(0,p.jsxs)(C.Item,{className:k,children:[(0,p.jsx)("img",{className:"rounded-full border-none ml-1",src:e.img,alt:e.name,height:30,width:30}),(0,p.jsxs)("div",{className:"flex flex-col",children:[(0,p.jsx)("div",{className:"text-gray-50",children:e.symbol}),(0,p.jsx)("div",{className:"text-sm",children:e.name})]})]},e.assetId)}))}):(0,p.jsx)("div",{className:A,children:"\ud83d\ude22 Oops, no token found!"})]})}var H=t(4243),_="flex1";function D(e){var n=e.value,t=(e.onChange,e.isReadOnly),r=(0,l.useState)(null),o=(0,s.Z)(r,2),i=o[0],c=o[1],u=(0,H.E)();return(0,l.useEffect)((function(){if(!n)return c(null);c(n)}),[n]),(0,p.jsxs)("div",{className:_,children:[(0,p.jsxs)(m.z,(0,a.Z)((0,a.Z)({},u.openButtonProps),{},{size:"md",className:"coin-selector",isDisabled:t,children:[i&&i.img&&(0,p.jsx)("img",{className:"rounded-full border-none ml-1",src:i.img,alt:i.name,height:20,width:20}),(0,p.jsx)("div",{className:"ml-2",children:null===i||void 0===i?void 0:i.name}),!t&&(0,p.jsx)(d.bTu,{className:"text-gray-500"})]})),(0,p.jsx)(H.V,(0,a.Z)((0,a.Z)({},u.dialogProps),{},{children:(0,p.jsx)(H.V.Content,{children:(0,p.jsx)(P,{onSelect:function(e){u.close(),c(f.Z.find((function(n){return n.assetId===e})))}})})}))]})}var M=t(1933),F=t(3246);var R=["amount","onChange","isReadOnly","showBalance","coin","gasFee","onInput"],O="flex bg-gray-700 rounded-2xl p-2 border border-gray-700",T="mx-2 h-10 bg-transparent placeholder:text-gray-300 outline-none text-xl flex items-center",z="flex flex-1 flex-col items-end",$="text-xs py-0 px-1 h-auto bg-primary-800/60 text-primary-500 hover:bg-primary-800",q=function(e){if(""!==e){var n=function(e){return"."===e?"0.":e}(e);return(0,i.parseUnits)(n,u.cS).toBigInt()}return(0,o.Gh)(0)},L=function(e){return null!=e?(0,i.formatUnits)(e,u.cS):e?void 0:""};function U(e){var n=e.amount,t=e.onChange,o=e.isReadOnly,i=e.showBalance,c=void 0===i||i,u=e.coin,d=e.gasFee,f=e.onInput,m=(0,r.Z)(e,R),x=(0,l.useState)(null),h=(0,s.Z)(x,2),g=h[0],v=h[1],p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,F.Os)();return(0,M.useQuery)("AssetsPage-balances",(function(){return n.getBalances()}),e)}({enabled:c}),y=p.data,b=null===y||void 0===y?void 0:y.find((function(e){return e.assetId===(null===u||void 0===u?void 0:u.assetId)}));function j(){var e=(null===b||void 0===b?void 0:b.amount)||BigInt(0);return e>BigInt(0)?e-(d||BigInt(0)):e}return(0,l.useEffect)((function(){null!=n&&v(n)}),[n]),{amount:g,formatted:L(g),setAmount:v,getInputProps:function(){return(0,a.Z)((0,a.Z)({},m),{},{coin:u,isReadOnly:o,value:L(g),displayType:o?"text":"input",onInput:f,onChange:function(e){if(!o){var n=""!==e?q(e):null;"function"===typeof t?t(n):v(n)}},isAllowed:function(e){var n=e.value;return q(n)<=0x10000000000000000},setMaxBalance:function(){null===f||void 0===f||f(),v(j())},balance:L((null===b||void 0===b?void 0:b.amount)||BigInt(0)),showBalance:c,showMaxButton:c})},hasEnoughBalance:j()>=(g||BigInt(0))}}var V=(0,l.forwardRef)((function(e,n){var t=e.value,a=e.displayType,r=e.onChange,o=e.coin,i=e.isAllowed,d=e.onChangeCoin,f=e.onInput,x=e.isReadOnly,h=e.coinSelectorDisabled,g=e.showMaxButton,v=e.showBalance,y=e.setMaxBalance,b=e.balance,j=e.autoFocus,w=(0,l.useState)(t),N=(0,s.Z)(w,2),I=N[0],Z=N[1];return(0,l.useEffect)((function(){t&&Z(t)}),[t]),(0,p.jsxs)("div",{className:O,children:[(0,p.jsx)(c.Z,{autoFocus:j,getInputRef:n,allowNegative:!1,defaultValue:t,value:I,displayType:a,isAllowed:i,onChange:function(e){null===r||void 0===r||r(e.target.value),Z(e.target.value)},decimalScale:u.cS,placeholder:"0",className:T,thousandSeparator:!1,onInput:f}),(0,p.jsxs)("div",{className:z,children:[(0,p.jsx)(D,{value:o,onChange:d,isReadOnly:x||h}),(v||g)&&(0,p.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[v&&(0,p.jsxs)("div",{className:"text-xs text-gray-400",children:["Balance: ",b]}),g&&(0,p.jsx)(m.z,{size:"sm",onPress:y,className:$,variant:"ghost",children:"Max"})]})]})]})}))},9385:function(e,n,t){t.d(n,{$:function(){return s}});var a=t(184);function s(){return(0,a.jsxs)("svg",{className:"-ml-1 h-5 w-5 animate-spin text-primary-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},5479:function(e,n,t){t.d(n,{P:function(){return r}});var a=t(9478),s=t(5442),r={name:"404",img:(0,s.Hn)("/icons/other.svg")},o=[{name:"Ether",symbol:"ETH",assetId:"0x0000000000000000000000000000000000000000000000000000000000000000",img:(0,s.Hn)("/icons/eth.svg")},{name:"DAI",symbol:"DAI",assetId:a.Bb,img:(0,s.Hn)("/icons/dai.svg")},{name:"Sway",symbol:"SWAY",assetId:a.p_,img:(0,s.Hn)("/icons/sway.svg")}];n.Z=o},5442:function(e,n,t){t.d(n,{Hn:function(){return i},_v:function(){return o},xr:function(){return r}});var a=t(6231),s=t.n(a),r=function(e){return{value:e}},o=function(e){return new Promise((function(n){return setTimeout(n,e)}))},i=function(e){return s()("/swayswap",e)}},7630:function(e,n,t){t.r(n),t.d(n,{default:function(){return S}});var a=t(1413),s=t(5861),r=t(885),o=t(7757),i=t.n(o),l=t(612),c=t(1933),u=t(6871),d=t(2791),f=t(1694),m=t.n(f),x=t(6140),h=t(5479),g=t(3426),v=t(9909),p=t(9478),y=t(3580),b=t(6861),j=t(7425),w=t(9385),N=t(3246),I=t(184),Z="font-mono my-4 px-4 py-3 text-sm text-slate-400 decoration-1 border border-dashed border-white/10 rounded-lg";function B(e){var n=e.loading,t=e.step,a=e.steps;return(0,I.jsx)("ul",{className:"w-full rounded-lg border border-gray-600 text-gray-900",children:a.map((function(e,s){return(0,I.jsxs)("li",{className:m()("space-between flex w-full items-center border-b border-gray-600 px-6 py-2 text-white",{"rounded-t-lg":0===s,"bg-primary-500":t===s&&n,"rounded-b-lg":s===a.length}),children:[(0,I.jsx)("div",{className:"flex-1",children:e}),t===s&&n&&(0,I.jsx)(w.$,{}),t>s&&(0,I.jsx)(j.xuy,{})]},s)}))})}function S(){var e=(0,N.cq)(),n=(0,u.s0)(),t=(0,d.useState)([h.Z[0],h.Z[1]]),o=(0,r.Z)(t,2),f=(0,r.Z)(o[0],2),m=f[0],j=f[1],w=o[1],S=(0,d.useState)(0),C=(0,r.Z)(S,2),E=C[0],k=C[1],A=(0,c.useQuery)("PoolPage-poolInfo",(function(){return e.callStatic.get_info()})).data,P=(0,v.M)({coin:m,onChangeCoin:function(e){return w([e,j])},gasFee:BigInt(1)}),H=(0,v.M)({coin:j,onChangeCoin:function(e){return w([e,j])}}),_=(0,c.useMutation)((0,s.Z)(i().mark((function n(){var t,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=P.amount,a=H.amount,t&&a){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,e.functions.deposit({forward:[t,m.assetId]});case 6:return k((function(e){return e+1})),n.next=9,e.functions.deposit({forward:[a,j.assetId]});case 9:return k((function(e){return e+1})),n.next=12,e.functions.add_liquidity(1,a,1e3,{variableOutputs:1});case 12:k((function(e){return e+1}));case 13:case"end":return n.stop()}}),n)}))),{onSuccess:function(){x.ZP.success("New pool created!"),n(b.i.wallet)},onError:function(e){var n,t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.errors;t.length&&"enough coins could not be found"===t[0].message&&x.ZP.error("Not enough balance in your wallet to create this pool.")},onSettled:function(){k(0)}});return _.isLoading?(0,I.jsx)("div",{className:"mt-6 mb-8 flex justify-center",children:(0,I.jsx)(B,{steps:["Deposit: ".concat(m.name),"Deposit: ".concat(j.name),"Provide liquidity","Done"],step:E,loading:_.isLoading,coinFrom:m,coinTo:j})}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{className:"mt-6 mb-4",children:(0,I.jsx)(v._,(0,a.Z)((0,a.Z)({},P.getInputProps()),{},{autoFocus:!0,coinSelectorDisabled:!0}))}),(0,I.jsx)("div",{className:"mb-6",children:(0,I.jsx)(v._,(0,a.Z)((0,a.Z)({},H.getInputProps()),{},{coinSelectorDisabled:!0}))}),A?(0,I.jsxs)("div",{className:Z,children:[(0,I.jsx)("h4",{className:"text-white mb-2 font-bold",children:"Reserves"}),(0,I.jsxs)("div",{className:"flex",children:[(0,I.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,I.jsxs)("span",{children:["ETH:"," ",(0,y.formatUnits)(A.eth_reserve,p.cS).toString()]}),(0,I.jsxs)("span",{children:["DAI:"," ",(0,y.formatUnits)(A.token_reserve,p.cS).toString()]})]}),A.eth_reserve>0&&A.token_reserve>0?(0,I.jsxs)("div",{className:"flex flex-col",children:[(0,I.jsx)("span",{children:(0,I.jsxs)(I.Fragment,{children:["ETH/DAI:"," ",+((0,l.He)(p.$g*A.eth_reserve)/(0,l.He)(A.token_reserve)/(0,l.He)(p.$g)).toFixed(6)]})}),(0,I.jsx)("span",{children:(0,I.jsxs)(I.Fragment,{children:["DAI/ETH:"," ",+((0,l.He)(p.$g*A.token_reserve)/(0,l.He)(A.eth_reserve)/(0,l.He)(p.$g)).toFixed(6)]})})]}):null]})]}):null,(0,I.jsx)(g.z,{isDisabled:!P.hasEnoughBalance||!H.hasEnoughBalance,isFull:!0,size:"lg",variant:"primary",onPress:function(){var e=P.amount,n=H.amount;if(!e)throw new Error('"fromAmount" is required');if(!n)throw new Error('"toAmount" is required');if(!P.hasEnoughBalance)throw new Error("Insufficient ".concat(m.name," balance"));if(!H.hasEnoughBalance)throw new Error("Insufficient ".concat(j.name," balance"));_.mutate()},children:P.hasEnoughBalance?H.hasEnoughBalance?"Confirm":"Insufficient ".concat(j.name," balance"):"Insufficient ".concat(m.name," balance")})]})}}}]);
//# sourceMappingURL=630.dc73e8fe.chunk.js.map