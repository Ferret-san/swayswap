"use strict";(self.webpackChunkswayswap_demo=self.webpackChunkswayswap_demo||[]).push([[367],{9909:function(e,n,t){t.d(n,{_:function(){return K},M:function(){return V}});var r=t(1413),a=t(885),s=t(4925),o=t(612),u=t(3580),i=t(2791),c=t(948),l=t(9478),d=t(3853),f=t(5479),m=t(3426),v=t(401),x=t(1694),p=t.n(x),h=t(3599),g=t(184),y=["className"],b="appearance-none w-full rounded-md bg-gray-700 px-4 py-2 focus-ring text-gray-100",w=(0,i.forwardRef)((function(e,n){var t=e.className,a=(0,s.Z)(e,y),o=(0,i.useRef)(null),u=(0,v.E)(a,o).inputProps;return(0,g.jsx)("input",(0,r.Z)({ref:(0,h.Z)([o,n]),className:p()(t,b)},u))})),j=t(2982),Z=t(7965),N=t(6367),S=t(686),I=["className","onAction","focusOnMount"];function k(e){var n=e.item,t=e.state,a=e.onAction,s=e.className,o=(0,i.useRef)(null),u=t.disabledKeys.has(n.key),c=t.selectionManager.focusedKey===n.key,l=(0,Z.iX)({key:n.key,isDisabled:u,onAction:a},t,o).menuItemProps;return(0,g.jsx)("li",(0,r.Z)((0,r.Z)({},l),{},{ref:o,className:s,"data-focused":c,children:n.rendered}))}var C=function(e){var n=e.className,t=e.onAction,a=e.focusOnMount,o=(0,s.Z)(e,I),u=(0,N.D)((0,r.Z)((0,r.Z)({},o),{},{selectionMode:"none"})),c=(0,i.useRef)(null),l=(0,Z.H9)(o,u,c).menuProps;return(0,i.useEffect)((function(){var e;a&&(null===(e=c.current)||void 0===e||e.focus())}),[]),(0,g.jsx)("ul",(0,r.Z)((0,r.Z)({},l),{},{ref:c,className:n,children:(0,j.Z)(u.collection).map((function(e){return(0,g.jsx)(k,{className:e.props.className,item:e,state:u,onAction:t},e.key)}))}))},A=S.ck;C.Item=A;var B="py-2 px-6 flex items-center gap-3 border-t border-gray-700\n  hover:bg-gray-700/50 hover:cursor-pointer focus-ring",_="px-6 py-4 border-t border-gray-700";function P(e){var n=e.onSelect,t=(0,i.useState)(""),r=(0,a.Z)(t,2),s=r[0],o=r[1];var u=f.Z.filter((function(e){var n;return Boolean(s.length)?null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(s.toLocaleLowerCase()):e})),c=Boolean(u.length);return(0,g.jsxs)("div",{children:[(0,g.jsxs)("header",{className:"py-4 px-6 pb-5",children:[(0,g.jsx)("h2",{className:"text-gray-50 text-lg mb-3",children:"Select a token"}),(0,g.jsx)(w,{type:"text",placeholder:"Search by name...",value:s,onChange:o})]}),c?(0,g.jsx)(C,{onAction:function(e){return null===n||void 0===n?void 0:n(e)},className:"pb-2",focusOnMount:!0,children:u.map((function(e){return(0,g.jsxs)(C.Item,{className:B,children:[(0,g.jsx)("img",{className:"rounded-full border-none ml-1",src:e.img,alt:e.name,height:30,width:30}),(0,g.jsxs)("div",{className:"flex flex-col",children:[(0,g.jsx)("div",{className:"text-gray-50",children:e.symbol}),(0,g.jsx)("div",{className:"text-sm",children:e.name})]})]},e.assetId)}))}):(0,g.jsx)("div",{className:_,children:"\ud83d\ude22 Oops, no token found!"})]})}var E=t(4243),M="flex1";function R(e){var n=e.value,t=(e.onChange,e.isReadOnly),s=(0,i.useState)(null),o=(0,a.Z)(s,2),u=o[0],c=o[1],l=(0,E.E)();return(0,i.useEffect)((function(){if(!n)return c(null);c(n)}),[n]),(0,g.jsxs)("div",{className:M,children:[(0,g.jsxs)(m.z,(0,r.Z)((0,r.Z)({},l.openButtonProps),{},{size:"md",className:"coin-selector",isDisabled:t,children:[u&&u.img&&(0,g.jsx)("img",{className:"rounded-full border-none ml-1",src:u.img,alt:u.name,height:20,width:20}),(0,g.jsx)("div",{className:"ml-2",children:null===u||void 0===u?void 0:u.name}),!t&&(0,g.jsx)(d.bTu,{className:"text-gray-500"})]})),(0,g.jsx)(E.V,(0,r.Z)((0,r.Z)({},l.dialogProps),{},{children:(0,g.jsx)(E.V.Content,{children:(0,g.jsx)(P,{onSelect:function(e){l.close(),c(f.Z.find((function(n){return n.assetId===e})))}})})}))]})}var T=t(1933),O=t(3246);var z=["amount","onChange","isReadOnly","showBalance","coin","gasFee","onInput"],D="flex bg-gray-700 rounded-2xl p-2 border border-gray-700",q="mx-2 h-10 bg-transparent placeholder:text-gray-300 outline-none text-xl flex items-center",F="flex flex-1 flex-col items-end",L="text-xs py-0 px-1 h-auto bg-primary-800/60 text-primary-500 hover:bg-primary-800",H=function(e){if(""!==e){var n=function(e){return"."===e?"0.":e}(e);return(0,u.parseUnits)(n,l.cS).toBigInt()}return(0,o.Gh)(0)},J=function(e){return null!=e?(0,u.formatUnits)(e,l.cS):e?void 0:""};function V(e){var n=e.amount,t=e.onChange,o=e.isReadOnly,u=e.showBalance,c=void 0===u||u,l=e.coin,d=e.gasFee,f=e.onInput,m=(0,s.Z)(e,z),v=(0,i.useState)(null),x=(0,a.Z)(v,2),p=x[0],h=x[1],g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,O.Os)();return(0,T.useQuery)("AssetsPage-balances",(function(){return n.getBalances()}),e)}({enabled:c}),y=g.data,b=null===y||void 0===y?void 0:y.find((function(e){return e.assetId===(null===l||void 0===l?void 0:l.assetId)}));function w(){var e=(null===b||void 0===b?void 0:b.amount)||BigInt(0);return e>BigInt(0)?e-(d||BigInt(0)):e}return(0,i.useEffect)((function(){null!=n&&h(n)}),[n]),{amount:p,formatted:J(p),setAmount:h,getInputProps:function(){return(0,r.Z)((0,r.Z)({},m),{},{coin:l,isReadOnly:o,value:J(p),displayType:o?"text":"input",onInput:f,onChange:function(e){if(!o){var n=""!==e?H(e):null;"function"===typeof t?t(n):h(n)}},isAllowed:function(e){var n=e.value;return H(n)<=0x10000000000000000},setMaxBalance:function(){null===f||void 0===f||f(),h(w())},balance:J((null===b||void 0===b?void 0:b.amount)||BigInt(0)),showBalance:c,showMaxButton:c})},hasEnoughBalance:w()>=(p||BigInt(0))}}var K=(0,i.forwardRef)((function(e,n){var t=e.value,r=e.displayType,s=e.onChange,o=e.coin,u=e.isAllowed,d=e.onChangeCoin,f=e.onInput,v=e.isReadOnly,x=e.coinSelectorDisabled,p=e.showMaxButton,h=e.showBalance,y=e.setMaxBalance,b=e.balance,w=e.autoFocus,j=(0,i.useState)(t),Z=(0,a.Z)(j,2),N=Z[0],S=Z[1];return(0,i.useEffect)((function(){t&&S(t)}),[t]),(0,g.jsxs)("div",{className:D,children:[(0,g.jsx)(c.Z,{autoFocus:w,getInputRef:n,allowNegative:!1,defaultValue:t,value:N,displayType:r,isAllowed:u,onChange:function(e){null===s||void 0===s||s(e.target.value),S(e.target.value)},decimalScale:l.cS,placeholder:"0",className:q,thousandSeparator:!1,onInput:f}),(0,g.jsxs)("div",{className:F,children:[(0,g.jsx)(R,{value:o,onChange:d,isReadOnly:v||x}),(h||p)&&(0,g.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[h&&(0,g.jsxs)("div",{className:"text-xs text-gray-400",children:["Balance: ",b]}),p&&(0,g.jsx)(m.z,{size:"sm",onPress:y,className:L,variant:"ghost",children:"Max"})]})]})]})}))},8957:function(e,n,t){t.d(n,{J:function(){return d}});var r=t(1694),a=t.n(r),s=t(2791),o=t(184),u="border border-gray-700 border-b-0",i="w-screen flex flex-1 items-center justify-center pb-14",c="bg-gray-800 w-[30rem] rounded-2xl py-4 m-2",l="px-5 flex justify-between text-xl",d=function(e){var n,t,r=e.children,l=null===(n=s.Children.toArray(r))||void 0===n?void 0:n.find((function(e){var n;return"PageTitle"===(null===(n=e.type)||void 0===n?void 0:n.id)})),d=null===(t=s.Children.toArray(r))||void 0===t?void 0:t.filter((function(e){var n;return"PageTitle"!==(null===(n=e.type)||void 0===n?void 0:n.id)}));return(0,o.jsx)("div",{className:i,children:(0,o.jsxs)("div",{className:c,children:[l,(0,o.jsx)("div",{className:a()(u,"my-4")}),(0,o.jsx)("div",{className:"px-5 pb-2",children:d})]})})},f=function(e){var n=e.children,t=e.elementRight;return(0,o.jsxs)("div",{className:l,children:[(0,o.jsx)("h2",{className:"flex items-center gap-2",children:n}),t]})};f.id="PageTitle",d.Title=f},5479:function(e,n,t){var r=t(9478),a=[{name:"Ether",symbol:"ETH",assetId:"0x0000000000000000000000000000000000000000000000000000000000000000",img:"/icons/eth.svg"},{name:"DAI",symbol:"DAI",assetId:r.Bb,img:"/icons/dai.svg"},{name:"Sway",symbol:"SWAY",assetId:r.p_,img:"/icons/sway.svg"}];n.Z=a},5442:function(e,n,t){t.d(n,{_:function(){return a},x:function(){return r}});var r=function(e){return{value:e}},a=function(e){return new Promise((function(n){return setTimeout(n,e)}))}},9367:function(e,n,t){t.r(n),t.d(n,{default:function(){return z}});var r=t(5861),a=t(885),s=t(7757),o=t.n(s),u=t(1933),i=t(6871),c=t(6856),l=t(2791),d=t(6140),f=t(3426),m=t(8957),v=t(3246);var x,p=t(6861),h=t(5442);!function(e){e.from="from",e.to="to"}(x||(x={}));var g=function(){var e=(0,r.Z)(o().mark((function e(n,t,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.callStatic.get_swap_with_maximum(r,{forward:[0,t]});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,r.Z)(o().mark((function e(n,t,r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.callStatic.get_swap_with_minimum(r,{forward:[0,t]});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,r.Z)(o().mark((function e(n,t){var r,a,s,u,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.amount,a=t.direction,s=t.from,a!==x.to||!r){e.next=8;break}return e.next=4,g(n,s,r);case 4:return u=e.sent,e.abrupt("return",u);case 8:if(!r){e.next=13;break}return e.next=11,y(n,s,r);case 11:return i=e.sent,e.abrupt("return",i);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),w=function(){var e=(0,r.Z)(o().mark((function e(n,t){var r,a,s,u,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.from,a=t.direction,s=t.amount,u=1e3,a!==x.to||!s){e.next=12;break}return e.next=5,g(n,r,s);case 5:if((i=e.sent).has_liquidity){e.next=8;break}throw new Error("Not enough liquidity on pool");case 8:return e.next=10,n.functions.swap_with_maximum(s,u,{forward:[i.amount,r],variableOutputs:1});case 10:e.next=20;break;case 12:if(a!==x.from||!s){e.next=20;break}return e.next=15,y(n,r,s);case 15:if((c=e.sent).has_liquidity){e.next=18;break}throw new Error("Not enough liquidity on pool");case 18:return e.next=20,n.functions.swap_with_minimum(c.amount,u,{forward:[s,r],variableOutputs:1});case 20:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),j=t(1413),Z=t(5479),N=t(9909),S=t(4942),I=t(9126),k=t(1694),C=t.n(k),A=t(184),B="\n    p-0 relative w-12 h-12\n    border-2 border-gray-700 bg-gray-800 rounded-2xl cursor-pointer\n    text-gray-400 hover:text-gray-50\n  ",_="transition-all",P="translate-x-[6px]",E="translate-x-[-6px]",M="rotate-180";function R(e){var n=e.onClick,t=(0,l.useState)(!1),r=(0,a.Z)(t,2),s=r[0],o=r[1];return(0,A.jsxs)(f.z,{onPress:function(){o((function(e){return!e})),null===n||void 0===n||n()},className:B,"aria-label":"Invert coins",children:[(0,A.jsx)(I.CSs,{size:24,className:C()(_,P,(0,S.Z)({},M,s))}),(0,A.jsx)(I.HTv,{size:24,className:C()(_,E,(0,S.Z)({},M,s))})]})}var T="flex items-center justify-center -my-5";function O(e){var n=e.previewAmount,t=e.onChange,r=(0,l.useRef)(x.from),s=(0,l.useState)([Z.Z[0],Z.Z[1]]),o=(0,a.Z)(s,2),u=(0,a.Z)(o[0],2),i=u[0],c=u[1],d=o[1],f=(0,N.M)({coin:i,onChangeCoin:function(e){return d([e,c])},onInput:function(){return r.current=x.from}}),m=(0,N.M)({coin:c,onChangeCoin:function(e){return d([e,c])},onInput:function(){return r.current=x.to}});return(0,l.useEffect)((function(){null===t||void 0===t||t({from:i.assetId,to:c.assetId,amount:r.current===x.from?f.amount:m.amount,direction:r.current})}),[f.amount,m.amount,i,c]),(0,l.useEffect)((function(){null!=n&&(r.current===x.from?m.setAmount(n):f.setAmount(n))}),[n]),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{className:"mt-4",children:(0,A.jsx)(N._,(0,j.Z)((0,j.Z)({},f.getInputProps()),{},{autoFocus:!0,coinSelectorDisabled:!0}))}),(0,A.jsx)("div",{className:T,children:(0,A.jsx)(R,{onClick:function(){r.current===x.to?(r.current=x.from,f.setAmount(m.amount),m.setAmount(null)):(r.current=x.to,m.setAmount(f.amount),f.setAmount(null)),d([c,i])}})}),(0,A.jsx)("div",{className:"mb-4",children:(0,A.jsx)(N._,(0,j.Z)((0,j.Z)({},m.getInputProps()),{},{coinSelectorDisabled:!0}))})]})}function z(){var e,n=(0,v.cq)(),t=(0,l.useState)(null),s=(0,a.Z)(t,2),x=s[0],g=s[1],y=(0,l.useState)(null),j=(0,a.Z)(y,2),Z=j[0],N=j[1],S=(0,l.useState)(!0),I=(0,a.Z)(S,2),k=I[0],C=I[1],B=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,t=(0,l.useState)(e),r=(0,a.Z)(t,2),s=r[0],o=r[1];return(0,l.useEffect)((function(){var t=setTimeout((function(){o(e)}),n);return function(){clearTimeout(t)}}),[e,n]),s}(Z),_=(0,i.s0)(),P=(0,u.useQuery)(["SwapPage-inactiveAmount",null===B||void 0===B||null===(e=B.amount)||void 0===e?void 0:e.toString(),null===B||void 0===B?void 0:B.direction,null===B||void 0===B?void 0:B.from,null===B||void 0===B?void 0:B.to],(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return",null);case 2:return e.abrupt("return",b(n,B));case 3:case"end":return e.stop()}}),e)}))),{onSuccess:function(e){null!=e&&(g(e.amount),C(e.has_liquidity))}}).isLoading,E=(0,u.useMutation)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,w(n,Z);case 4:return e.next=6,(0,h._)(1e3);case 6:case"end":return e.stop()}}),e)}))),{onSuccess:function(){d.ZP.success("Swap made successfully!"),_(p.i.wallet)}}),M=E.mutate,R=E.isLoading,T=P||R||!Z||!k||!x||!Z.amount;return(0,A.jsxs)(m.J,{children:[(0,A.jsxs)(m.J.Title,{children:[(0,A.jsx)(c.mzl,{className:"text-primary-500"}),"Swap"]}),(0,A.jsx)(O,{previewAmount:x,onChange:N}),(0,A.jsx)(f.z,{isFull:!0,size:"lg",variant:"primary",isDisabled:T,onPress:function(){return M()},children:k?R?"Loading...":"Swap":"Insufficient liquidity"})]})}}}]);
//# sourceMappingURL=367.b5b91fbe.chunk.js.map