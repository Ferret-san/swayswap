"use strict";(self.webpackChunkswayswap_demo=self.webpackChunkswayswap_demo||[]).push([[388],{9786:function(n,e,t){t.d(e,{_:function(){return J},M:function(){return K}});var r=t(1413),a=t(885),o=t(4925),s=t(612),u=t(3580),i=t(2791),c=t(948),l=t(9478),d=t(3853),f=t(5479),m=t(3426),v=t(401),x=t(1694),p=t.n(x),h=t(3599),g=t(184),y=["className"],b="appearance-none w-full rounded-md bg-gray-700 px-4 py-2 focus-ring text-gray-100",w=(0,i.forwardRef)((function(n,e){var t=n.className,a=(0,o.Z)(n,y),s=(0,i.useRef)(null),u=(0,v.E)(a,s).inputProps;return(0,g.jsx)("input",(0,r.Z)({ref:(0,h.Z)([s,e]),className:p()(t,b)},u))})),j=t(2982),Z=t(7965),N=t(6367),I=t(686),S=["className","onAction","focusOnMount"];function k(n){var e=n.item,t=n.state,a=n.onAction,o=n.className,s=(0,i.useRef)(null),u=t.disabledKeys.has(e.key),c=t.selectionManager.focusedKey===e.key,l=(0,Z.iX)({key:e.key,isDisabled:u,onAction:a},t,s).menuItemProps;return(0,g.jsx)("li",(0,r.Z)((0,r.Z)({},l),{},{ref:s,className:o,"data-focused":c,children:e.rendered}))}var A=function(n){var e=n.className,t=n.onAction,a=n.focusOnMount,s=(0,o.Z)(n,S),u=(0,N.D)((0,r.Z)((0,r.Z)({},s),{},{selectionMode:"none"})),c=(0,i.useRef)(null),l=(0,Z.H9)(s,u,c).menuProps;return(0,i.useEffect)((function(){var n;a&&(null===(n=c.current)||void 0===n||n.focus())}),[]),(0,g.jsx)("ul",(0,r.Z)((0,r.Z)({},l),{},{ref:c,className:e,children:(0,j.Z)(u.collection).map((function(n){return(0,g.jsx)(k,{className:n.props.className,item:n,state:u,onAction:t},n.key)}))}))},C=I.ck;A.Item=C;var B="py-2 px-6 flex items-center gap-3 border-t border-gray-700\n  hover:bg-gray-700/50 hover:cursor-pointer focus-ring",_="px-6 py-4 border-t border-gray-700";function P(n){var e=n.onSelect,t=(0,i.useState)(""),r=(0,a.Z)(t,2),o=r[0],s=r[1];var u=f.Z.filter((function(n){var e;return Boolean(o.length)?null===(e=n.name)||void 0===e?void 0:e.toLowerCase().includes(o.toLocaleLowerCase()):n})),c=Boolean(u.length);return(0,g.jsxs)("div",{children:[(0,g.jsxs)("header",{className:"py-4 px-6 pb-5",children:[(0,g.jsx)("h2",{className:"text-gray-50 text-lg mb-3",children:"Select a token"}),(0,g.jsx)(w,{type:"text",placeholder:"Search by name...",value:o,onChange:s})]}),c?(0,g.jsx)(A,{onAction:function(n){return null===e||void 0===e?void 0:e(n)},className:"pb-2",focusOnMount:!0,children:u.map((function(n){return(0,g.jsxs)(A.Item,{className:B,children:[(0,g.jsx)("img",{className:"rounded-full border-none ml-1",src:n.img,alt:n.name,height:30,width:30}),(0,g.jsxs)("div",{className:"flex flex-col",children:[(0,g.jsx)("div",{className:"text-gray-50",children:n.symbol}),(0,g.jsx)("div",{className:"text-sm",children:n.name})]})]},n.assetId)}))}):(0,g.jsx)("div",{className:_,children:"\ud83d\ude22 Oops, no token found!"})]})}var O=t(4243),E="flex1";function M(n){var e=n.value,t=(n.onChange,n.isReadOnly),o=(0,i.useState)(null),s=(0,a.Z)(o,2),u=s[0],c=s[1],l=(0,O.E)();return(0,i.useEffect)((function(){if(!e)return c(null);c(e)}),[e]),(0,g.jsxs)("div",{className:E,children:[(0,g.jsxs)(m.z,(0,r.Z)((0,r.Z)({},l.openButtonProps),{},{size:"md",className:"coin-selector",isDisabled:t,children:[u&&u.img&&(0,g.jsx)("img",{className:"rounded-full border-none ml-1",src:u.img,alt:u.name,height:20,width:20}),(0,g.jsx)("div",{className:"ml-2",children:null===u||void 0===u?void 0:u.name}),!t&&(0,g.jsx)(d.bTu,{className:"text-gray-500"})]})),(0,g.jsx)(O.V,(0,r.Z)((0,r.Z)({},l.dialogProps),{},{children:(0,g.jsx)(O.V.Content,{children:(0,g.jsx)(P,{onSelect:function(n){l.close(),c(f.Z.find((function(e){return e.assetId===n})))}})})}))]})}var R=t(1062),T=["amount","onChange","isReadOnly","showBalance","coin","gasFee","onInput"],z="flex bg-gray-700 rounded-2xl p-2 border border-gray-700",D="mx-2 h-10 bg-transparent placeholder:text-gray-300 outline-none text-xl flex items-center",H="flex flex-1 flex-col items-end",q="text-xs py-0 px-1 h-auto bg-primary-800/60 text-primary-500 hover:bg-primary-800",F=function(n){if(""!==n){var e=function(n){return"."===n?"0.":n}(n);return(0,u.parseUnits)(e,l.cS).toBigInt()}return(0,s.Gh)(0)},L=function(n){return null!=n?(0,u.formatUnits)(n,l.cS):""};function K(n){var e=n.amount,t=n.onChange,s=n.isReadOnly,u=n.showBalance,c=void 0===u||u,l=n.coin,d=n.gasFee,f=n.onInput,m=(0,o.Z)(n,T),v=(0,i.useState)(null),x=(0,a.Z)(v,2),p=x[0],h=x[1],g=(0,R.l)({enabled:c}).data,y=null===g||void 0===g?void 0:g.find((function(n){return n.assetId===(null===l||void 0===l?void 0:l.assetId)}));function b(){var n=(null===y||void 0===y?void 0:y.amount)||BigInt(0);return n>BigInt(0)?n-(d||BigInt(0)):n}return(0,i.useEffect)((function(){void 0!==e&&h(e)}),[e]),{amount:p,formatted:L(p),setAmount:h,getInputProps:function(){return(0,r.Z)((0,r.Z)({},m),{},{coin:l,isReadOnly:s,value:L(p),displayType:s?"text":"input",onInput:f,onChange:function(n){if(!s){var e=""!==n?F(n):null;"function"===typeof t?t(e):h(e)}},isAllowed:function(n){var e=n.value;return F(e)<=0x10000000000000000},setMaxBalance:function(){null===f||void 0===f||f(),h(b())},balance:L((null===y||void 0===y?void 0:y.amount)||BigInt(0)),showBalance:c,showMaxButton:c})},hasEnoughBalance:b()>=(p||BigInt(0))}}var J=(0,i.forwardRef)((function(n,e){var t=n.value,r=n.displayType,o=n.onChange,s=n.coin,u=n.isAllowed,d=n.onChangeCoin,f=n.onInput,v=n.isReadOnly,x=n.coinSelectorDisabled,p=n.showMaxButton,h=n.showBalance,y=n.setMaxBalance,b=n.balance,w=n.autoFocus,j=(0,i.useState)(t),Z=(0,a.Z)(j,2),N=Z[0],I=Z[1];return(0,i.useEffect)((function(){null!=t&&I(t)}),[t]),(0,g.jsxs)("div",{className:z,children:[(0,g.jsx)(c.Z,{autoFocus:w,getInputRef:e,allowNegative:!1,defaultValue:t,value:N,displayType:r,isAllowed:u,onChange:function(n){null===o||void 0===o||o(n.target.value),I(n.target.value)},decimalScale:l.cS,placeholder:"0",className:D,thousandSeparator:!1,onInput:f}),(0,g.jsxs)("div",{className:H,children:[(0,g.jsx)(M,{value:s,onChange:d,isReadOnly:v||x}),(h||p)&&(0,g.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[h&&(0,g.jsxs)("div",{className:"text-xs text-gray-400",children:["Balance: ",b]}),p&&(0,g.jsx)(m.z,{size:"sm",onPress:y,className:q,variant:"ghost",children:"Max"})]})]})]})}))},8957:function(n,e,t){t.d(e,{J:function(){return d}});var r=t(1694),a=t.n(r),o=t(2791),s=t(184),u="border border-gray-700 border-b-0",i="w-screen flex flex-1 items-center justify-center pb-14",c="bg-gray-800 w-[30rem] rounded-2xl py-4 m-2",l="px-5 flex justify-between text-xl",d=function(n){var e,t,r=n.children,l=null===(e=o.Children.toArray(r))||void 0===e?void 0:e.find((function(n){var e;return"PageTitle"===(null===(e=n.type)||void 0===e?void 0:e.id)})),d=null===(t=o.Children.toArray(r))||void 0===t?void 0:t.filter((function(n){var e;return"PageTitle"!==(null===(e=n.type)||void 0===e?void 0:e.id)}));return(0,s.jsx)("div",{className:i,children:(0,s.jsxs)("div",{className:c,children:[l,(0,s.jsx)("div",{className:a()(u,"my-4")}),(0,s.jsx)("div",{className:"px-5 pb-2",children:d})]})})},f=function(n){var e=n.children,t=n.elementRight;return(0,s.jsxs)("div",{className:l,children:[(0,s.jsx)("h2",{className:"flex items-center gap-2",children:e}),t]})};f.id="PageTitle",d.Title=f},1062:function(n,e,t){t.d(e,{l:function(){return o}});var r=t(1933),a=t(3246);function o(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,a.Os)();return(0,r.useQuery)("AssetsPage-balances",(function(){return e.getBalances()}),n)}},5479:function(n,e,t){t.d(e,{P:function(){return o}});var r=t(9478),a=t(5442),o={name:"404",img:(0,a.Hn)("/icons/other.svg")},s=[{name:"Ether",symbol:"ETH",assetId:"0x0000000000000000000000000000000000000000000000000000000000000000",img:(0,a.Hn)("/icons/eth.svg")},{name:"DAI",symbol:"DAI",assetId:r.Bb,img:(0,a.Hn)("/icons/dai.svg")},{name:"Sway",symbol:"SWAY",assetId:r.p_,img:(0,a.Hn)("/icons/sway.svg")}];e.Z=s},5442:function(n,e,t){t.d(e,{Hn:function(){return u},_v:function(){return s},xr:function(){return o}});var r=t(6231),a=t.n(r),o=function(n){return{value:n}},s=function(n){return new Promise((function(e){return setTimeout(e,n)}))},u=function(n){return a()("/swayswap",n)}},9505:function(n,e,t){t.r(e),t.d(e,{default:function(){return L}});var r=t(5861),a=t(885),o=t(7757),s=t.n(o),u=t(1933),i=t(6871),c=t(6856),l=t(2791),d=t(6140),f=t(3426),m=t(8957),v=t(3246);var x,p=t(6861),h=t(5442);!function(n){n.from="from",n.to="to"}(x||(x={}));var g=function(){var n=(0,r.Z)(s().mark((function n(e,t,r){var a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.callStatic.get_swap_with_maximum(r,{forward:[0,t]});case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}(),y=function(){var n=(0,r.Z)(s().mark((function n(e,t,r){var a;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.callStatic.get_swap_with_minimum(r,{forward:[0,t]});case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}(),b=function(){var n=(0,r.Z)(s().mark((function n(e,t){var r,a,o,u,i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.amount,a=t.direction,o=t.from,a!==x.to||!r){n.next=8;break}return n.next=4,g(e,o,r);case 4:return u=n.sent,n.abrupt("return",u);case 8:if(!r){n.next=13;break}return n.next=11,y(e,o,r);case 11:return i=n.sent,n.abrupt("return",i);case 13:return n.abrupt("return",null);case 14:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),w=function(){var n=(0,r.Z)(s().mark((function n(e,t){var r,a,o,u,i,c;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.from,a=t.direction,o=t.amount,u=1e3,a!==x.to||!o){n.next=12;break}return n.next=5,g(e,r,o);case 5:if((i=n.sent).has_liquidity){n.next=8;break}throw new Error("Not enough liquidity on pool");case 8:return n.next=10,e.functions.swap_with_maximum(o,u,{forward:[i.amount,r],variableOutputs:1});case 10:n.next=20;break;case 12:if(a!==x.from||!o){n.next=20;break}return n.next=15,y(e,r,o);case 15:if((c=n.sent).has_liquidity){n.next=18;break}throw new Error("Not enough liquidity on pool");case 18:return n.next=20,e.functions.swap_with_minimum(c.amount,u,{forward:[o,r],variableOutputs:1});case 20:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),j=t(1413),Z=t(9754),N=t(9786),I=t(4942),S=t(9126),k=t(1694),A=t.n(k),C=t(184),B="\n    p-0 relative w-12 h-12\n    border-2 border-gray-700 bg-gray-800 rounded-2xl cursor-pointer\n    text-gray-400 hover:text-gray-50\n  ",_="transition-all",P="translate-x-[6px]",O="translate-x-[-6px]",E="rotate-180";function M(n){var e=n.onClick,t=(0,l.useState)(!1),r=(0,a.Z)(t,2),o=r[0],s=r[1];return(0,C.jsxs)(f.z,{onPress:function(){s((function(n){return!n})),null===e||void 0===e||e()},className:B,"aria-label":"Invert coins",children:[(0,C.jsx)(S.CSs,{size:24,className:A()(_,P,(0,I.Z)({},E,o))}),(0,C.jsx)(S.HTv,{size:24,className:A()(_,O,(0,I.Z)({},E,o))})]})}var R=t(5479),T=(0,Z.cn)(x.from),z=(0,Z.cn)([R.Z[0],R.Z[1]]),D=(0,Z.cn)(null),H="flex items-center justify-center -my-5";function q(n){var e=n.previewAmount,t=n.onChange,r=(0,Z.KO)(D),o=(0,a.Z)(r,2),s=o[0],u=o[1],i=(0,Z.KO)(T),c=(0,a.Z)(i,2),d=c[0],f=c[1],m=(0,Z.KO)(z),v=(0,a.Z)(m,2),p=(0,a.Z)(v[0],2),h=p[0],g=p[1],y=v[1],b=(0,l.useRef)(d),w=(0,N.M)({coin:h,onChangeCoin:function(n){return y([n,g])},onInput:function(){return b.current=x.from}}),I=(0,N.M)({coin:g,onChangeCoin:function(n){return y([n,g])},onInput:function(){return b.current=x.to}});return(0,l.useEffect)((function(){b.current===x.to?I.setAmount(s):w.setAmount(s)}),[]),(0,l.useEffect)((function(){var n=b.current===x.from?w.amount:I.amount;u(n),f(null===b||void 0===b?void 0:b.current),null===t||void 0===t||t({from:h.assetId,to:g.assetId,amount:n,direction:b.current})}),[w.amount,I.amount,h,g]),(0,l.useEffect)((function(){null!=e&&(b.current===x.from?I.setAmount(e):w.setAmount(e))}),[e]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"mt-4",children:(0,C.jsx)(N._,(0,j.Z)((0,j.Z)({},w.getInputProps()),{},{autoFocus:!0,coinSelectorDisabled:!0}))}),(0,C.jsx)("div",{className:H,children:(0,C.jsx)(M,{onClick:function(){b.current===x.to?(b.current=x.from,w.setAmount(I.amount),I.setAmount(null)):(b.current=x.to,I.setAmount(w.amount),w.setAmount(null)),y([g,h])}})}),(0,C.jsx)("div",{className:"mb-4",children:(0,C.jsx)(N._,(0,j.Z)((0,j.Z)({},I.getInputProps()),{},{coinSelectorDisabled:!0}))})]})}var F=t(1062);function L(){var n,e=(0,v.cq)(),t=(0,l.useState)(null),o=(0,a.Z)(t,2),g=o[0],y=o[1],j=(0,l.useState)(null),Z=(0,a.Z)(j,2),N=Z[0],I=Z[1],S=(0,l.useState)(!0),k=(0,a.Z)(S,2),A=k[0],B=k[1],_=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,t=(0,l.useState)(n),r=(0,a.Z)(t,2),o=r[0],s=r[1];return(0,l.useEffect)((function(){var t=setTimeout((function(){s(n)}),e);return function(){clearTimeout(t)}}),[n,e]),o}(N),P=(0,F.l)().data,O=(0,i.s0)(),E=(0,u.useQuery)(["SwapPage-inactiveAmount",null===_||void 0===_||null===(n=_.amount)||void 0===n?void 0:n.toString(),null===_||void 0===_?void 0:_.direction,null===_||void 0===_?void 0:_.from,null===_||void 0===_?void 0:_.to],(0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==_&&void 0!==_&&_.amount){n.next=2;break}return n.abrupt("return",null);case 2:return n.abrupt("return",b(e,_));case 3:case"end":return n.stop()}}),n)}))),{onSuccess:function(n){null!=n&&(y(n.amount),B(n.has_liquidity))}}).isLoading,M=(0,u.useMutation)((0,r.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(N){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,w(e,N);case 4:return n.next=6,(0,h._v)(1e3);case 6:case"end":return n.stop()}}),n)}))),{onSuccess:function(){d.ZP.success("Swap made successfully!"),O(p.i.wallet)}}),R=M.mutate,T=M.isLoading,z=!N||!N.amount||!function(n,e){return null===n||void 0===n?void 0:n.find((function(n){return n.assetId===e}))}(P,N.direction===x.to?N.to:N.from),D=E||T||!A||!g||z;return(0,C.jsxs)(m.J,{children:[(0,C.jsxs)(m.J.Title,{children:[(0,C.jsx)(c.mzl,{className:"text-primary-500"}),"Swap"]}),(0,C.jsx)(q,{previewAmount:g,onChange:I}),(0,C.jsx)(f.z,{isFull:!0,size:"lg",variant:"primary",isDisabled:D,onPress:function(){return R()},children:A?T?"Loading...":"Swap":"Insufficient liquidity"})]})}}}]);
//# sourceMappingURL=388.a80c6be6.chunk.js.map